<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Venkatesh Chits - Enterprise Demo</title>

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet"/>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --glass-bg: rgba(255,255,255,0.10);
      --glass-strong: rgba(255,255,255,0.18);
      --accent: #00d4ff;
      --muted-white: rgba(153, 26, 26, 0.85);
    }
    html,body { height:100%; margin:0; font-family: "Segoe UI", Roboto, Helvetica, Arial; background: linear-gradient(135deg,#0f172a 0%, #1f2a44 40%, #4b235d 100%); color: #b79494; }
    .sidebar { width:270px; position:fixed; top:0; left:0; height:100%; padding:20px 14px; background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.08)); backdrop-filter: blur(8px); box-shadow: 0 8px 30px rgba(0,0,0,0.4); border-right: 1px solid rgba(255,255,255,0.02); z-index:999; }
    .sidebar h3 { font-size:20px; margin-bottom:6px; letter-spacing:0.4px; color:var(--muted-white); }
    .sidebar p.small { font-size:12px; color:rgba(255,255,255,0.65); margin-top:0; }
    .sidebar a.menu { display:flex; align-items:center; gap:10px; padding:10px 12px; margin:6px 2px; border-radius:10px; color:rgba(101, 223, 99, 0.95); text-decoration:none; }
    .sidebar a.menu:hover, .sidebar a.menu.active { background: rgba(255,255,255,0.04); box-shadow: inset 0 0 0 1px rgba(255,255,255,0.02); transform:translateX(4px); }
    .content { margin-left:290px; padding:22px; min-height:100vh; }
    .topbar { display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:18px; }
    .card-glass { background:var(--glass-bg); border-radius:14px; padding:14px; box-shadow: 0 8px 24px rgba(0,0,0,0.35); border: 1px solid rgba(255,255,255,0.03); }
    .card-glass-strong { background:var(--glass-strong); }
    .small-muted { color: rgba(173, 118, 118, 0.7); font-size:13px; }
    .badge-soft { background: rgba(255,255,255,0.08); color:var(--muted-white); padding:6px 10px; border-radius:10px; }
    .btn-ghost { background:transparent; color:var(--muted-white); border:1px solid rgba(255,255,255,0.06); }
    .table thead th { border-bottom:1px solid rgba(255,255,255,0.06); color:var(--muted-white); }
    .table tbody td { color: rgba(218, 61, 61, 0.95); }
    .search-input { max-width:380px; }
    .toast-container { position: fixed; top:20px; right:20px; z-index:2000; }
    canvas { width:100% !important; height:320px !important; border-radius:12px; }

    /* responsive */
    @media (max-width: 900px){
      .sidebar { width:80px; padding:12px; }
      .sidebar h3, .sidebar p.small { display:none; }
      .content { margin-left:100px; padding:12px; }
    }
  </style>
</head>
<body onload="initDemo()">

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <h3>Venkatesh Chits</h3>
    <p class="small">Enterprise Demo • Offline • Click everything</p>

    <a class="menu active" href="#" onclick="navigate('dashboard', event)"><i class="bi bi-speedometer2"></i><span class="label"> Dashboard</span></a>
    <a class="menu" href="#" onclick="navigate('addMember', event)"><i class="bi bi-people"></i><span class="label"> Add Member</span></a>
    <a class="menu" href="#" onclick="navigate('addGroup', event)"><i class="bi bi-collection"></i><span class="label"> Add Group</span></a>
    <a class="menu" href="#" onclick="navigate('collection', event)"><i class="bi bi-cash-coin"></i><span class="label"> Collection</span></a>
    <a class="menu" href="#" onclick="navigate('auction', event)"><i class="bi bi-hammer"></i><span class="label"> Auction</span></a>
    <a class="menu" href="#" onclick="navigate('accounts', event)"><i class="bi bi-book"></i><span class="label"> Accounts</span></a>
    <a class="menu" href="#" onclick="navigate('reports', event)"><i class="bi bi-bar-chart"></i><span class="label"> Reports</span></a>
    <a class="menu" href="#" onclick="navigate('settings', event)"><i class="bi bi-gear"></i><span class="label"> Settings</span></a>
    <hr style="border-color: rgba(255,255,255,0.03); margin:14px 0;">
    <a class="menu" href="#" onclick="navigate('logout', event)"><i class="bi bi-box-arrow-right"></i><span class="label"> Logout</span></a>
    <div style="position:absolute;bottom:18px;left:18px; right:18px;">
      <div class="small-muted">Demo mode — No DB</div>
      <div style="margin-top:8px;"><small class="small-muted">Try: Search, Sort columns, Paginate, Click charts</small></div>
    </div>
  </aside>

  <!-- CONTENT -->
  <main class="content">
    <div class="topbar">
      <div style="display:flex; gap:12px; align-items:center;">
        <div class="card-glass-strong" style="padding:10px 14px; border-radius:12px;">
          <strong style="font-size:18px">Admin Console</strong><div class="small-muted">Venkatesh Chits • Demo</div>
        </div>

        <div class="card-glass" style="display:flex; gap:8px; align-items:center; padding:8px 12px;">
          <i class="bi bi-people"></i>
          <div style="text-align:left;">
            <div style="font-weight:600;">128 Members</div>
            <div class="small-muted">Active / Pending</div>
          </div>
        </div>
      </div>

      <div style="display:flex; gap:8px; align-items:center;">
        <input id="globalSearch" oninput="applyMemberFilter()" class="form-control form-control-sm search-input" placeholder="Search members or phone..." />
        <button class="btn btn-sm btn-outline-light" onclick="resetFilters()">Reset</button>
        <div style="min-width:90px; text-align:right;">
          <div id="clock" style="font-weight:600"></div>
          <div class="small-muted" id="dateStr"></div>
        </div>
      </div>
    </div>

    <!-- === DASHBOARD === -->
    <section id="dashboardSection" class="card-glass" style="padding:18px; margin-bottom:14px;">
      <div style="display:flex; gap:14px; align-items:stretch; flex-wrap:wrap;">
        <div style="flex:1; min-width:220px;" class="card-glass">
          <div class="small-muted">Total Members</div><div style="font-size:20px; font-weight:700;">128</div>
        </div>
        <div style="flex:1; min-width:220px;" class="card-glass">
          <div class="small-muted">Total Groups</div><div style="font-size:20px; font-weight:700;">20</div>
        </div>
        <div style="flex:1; min-width:220px;" class="card-glass">
          <div class="small-muted">Pending Dues</div><div style="font-size:20px; font-weight:700; color:#ffdd57;">₹ 1,25,400</div>
        </div>
        <div style="flex:1; min-width:220px;" class="card-glass">
          <div class="small-muted">Auctions this month</div><div style="font-size:20px; font-weight:700;">4</div>
        </div>
      </div>

      <div style="display:flex; gap:14px; margin-top:16px; flex-wrap:wrap;">
        <div style="flex:1 1 520px;" class="card-glass">
          <h6 style="margin-top:6px;">Monthly Collection Trend</h6>
          <canvas id="chartCollectionTrend"></canvas>
        </div>

        <div style="flex:1 1 360px; display:flex; flex-direction:column; gap:10px;">
          <div class="card-glass" style="padding:12px;">
            <h6 style="margin:0">Group-wise Share</h6>
            <canvas id="chartGroupShare" style="height:240px;"></canvas>
          </div>
          <div class="card-glass" style="padding:10px; display:flex; gap:10px; align-items:center; justify-content:space-between;">
            <div>
              <div class="small-muted">This Month Collections</div>
              <div style="font-weight:700; font-size:18px;">₹ 2,45,600</div>
            </div>
            <div>
              <button class="btn btn-sm btn-outline-light" onclick="exportFakePDF()">⬇ Download PDF</button>
              <button class="btn btn-sm btn-success" onclick="showToast('Shared via WhatsApp (fake)')"><i class="bi bi-whatsapp"></i></button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- === MEMBERS TABLE SECTION === -->
    <section id="membersSection" style="margin-top:8px;">
      <div class="card-glass" style="padding:14px;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <h5 style="margin:0;">Members</h5>
          <div style="display:flex; gap:8px; align-items:center;">
            <select id="statusFilter" class="form-select form-select-sm" style="width:160px;" onchange="applyMemberFilter()">
              <option value="">All status</option>
              <option value="Active">Active</option>
              <option value="Pending">Pending</option>
            </select>
            <select id="groupFilter" class="form-select form-select-sm" style="width:180px;" onchange="applyMemberFilter()">
              <option value="">All groups</option>
            </select>
            <button class="btn btn-sm btn-outline-light" onclick="openAddMemberModal()">+ Add Member</button>
          </div>
        </div>

        <div style="margin-top:12px; overflow:auto;">
          <table class="table table-borderless table-hover">
            <thead>
              <tr>
                <th style="cursor:pointer" onclick="sortMembers('id')"># <i class="bi bi-arrow-down-up"></i></th>
                <th style="cursor:pointer" onclick="sortMembers('name')">Name <i class="bi bi-arrow-down-up"></i></th>
                <th style="cursor:pointer" onclick="sortMembers('phone')">Phone</th>
                <th style="cursor:pointer" onclick="sortMembers('group')">Group</th>
                <th style="cursor:pointer" onclick="sortMembers('amount')">Chit ₹</th>
                <th style="cursor:pointer" onclick="sortMembers('status')">Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="membersTbody"></tbody>
          </table>
        </div>

        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:8px;">
          <div class="small-muted" id="membersInfo"></div>
          <nav>
            <ul class="pagination pagination-sm" id="membersPager"></ul>
          </nav>
        </div>
      </div>
    </section>

    <!-- === GROUPS SECTION === -->
    <section id="groupsSection" style="margin-top:12px;">
      <div class="card-glass" style="padding:14px;">
        <div style="display:flex; justify-content:space-between;">
          <h5 style="margin:0">Groups</h5>
          <div>
            <button class="btn btn-sm btn-outline-light" onclick="openAddGroupModal()">+ Add Group</button>
          </div>
        </div>

        <div style="margin-top:12px; overflow:auto;">
          <table class="table table-borderless table-hover">
            <thead><tr><th>Group</th><th>Chit Value</th><th>Members</th><th>Status</th><th>Action</th></tr></thead>
            <tbody id="groupsTbody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- === COLLECTIONS / AUCTION / ACCOUNTS / REPORTS SECTIONS (All modular) === -->
    <section id="collectionSection" style="margin-top:12px; display:none;">
      <div class="card-glass" style="padding:14px;">
        <h5 style="margin:0">Collection</h5>
        <div class="row mt-3">
          <div class="col-md-4">
            <input id="collectMember" class="form-control form-control-sm" placeholder="Member name or phone">
          </div>
          <div class="col-md-3">
            <input id="collectAmount" type="number" class="form-control form-control-sm" placeholder="Amount (₹)">
          </div>
          <div class="col-md-3">
            <select id="collectMode" class="form-select form-select-sm"><option>Cash</option><option>UPI</option><option>Cheque</option></select>
          </div>
          <div class="col-md-2">
            <button class="btn btn-success btn-sm" onclick="markCollection()">Mark Collection</button>
          </div>
        </div>

        <div style="margin-top:14px;">
          <h6>Recent Collections</h6>
          <table class="table table-borderless">
            <thead><tr><th>Date</th><th>Member</th><th>Group</th><th>Amount</th><th>Mode</th></tr></thead>
            <tbody id="collectionsTbody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="auctionSection" style="margin-top:12px; display:none;">
      <div class="card-glass" style="padding:14px;">
        <h5 style="margin:0">Auction</h5>
        <div style="margin-top:10px;">
          <button class="btn btn-warning btn-sm" onclick="startFakeAuction()">Start Auction (demo)</button>
          <button class="btn btn-outline-light btn-sm" onclick="loadAuctionHistory()">View History</button>
        </div>
        <div style="margin-top:12px;">
          <canvas id="auctionTimeline"></canvas>
        </div>
      </div>
    </section>

    <section id="accountsSection" style="margin-top:12px; display:none;">
      <div class="card-glass" style="padding:14px;">
        <h5 style="margin:0">Accounts</h5>
        <div style="margin-top:10px;">
          <button class="btn btn-sm btn-primary" onclick="showToast('Journal entry saved (demo)')">Add Journal Entry</button>
          <button class="btn btn-sm btn-outline-light" onclick="showToast('Year-end closing simulated')">Year End Close</button>
        </div>

        <div style="margin-top:12px;">
          <table class="table table-borderless">
            <thead><tr><th>Date</th><th>Description</th><th>Debit</th><th>Credit</th><th>Balance</th></tr></thead>
            <tbody id="ledgerTbody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="reportsSection" style="margin-top:12px; display:none;">
      <div class="card-glass" style="padding:14px;">
        <h5 style="margin:0">Reports</h5>
        <div style="margin-top:10px; display:flex; gap:8px;">
          <button class="btn btn-sm btn-primary" onclick="showToast('Member-wise report generated (demo)')">Member-wise</button>
          <button class="btn btn-sm btn-success" onclick="showToast('Group report generated (demo)')">Group</button>
          <button class="btn btn-sm btn-warning" onclick="showToast('Auction report generated (demo)')">Auction</button>
          <button class="btn btn-sm btn-danger" onclick="showToast('Pending dues report generated (demo)')">Pending Dues</button>
        </div>

        <div style="margin-top:12px;">
          <h6>Report Preview</h6>
          <div class="card-glass" style="padding:12px;">
            <pre id="reportPreview" style="color:#fff; background:transparent; border:none; margin:0; white-space:pre-wrap;"></pre>
          </div>
        </div>
      </div>
    </section>

    <section id="settingsSection" style="margin-top:12px; display:none;">
      <div class="card-glass" style="padding:14px;">
        <h5 style="margin:0">Settings</h5>
        <div style="margin-top:8px;">
          <button class="btn btn-sm btn-outline-light" onclick="showToast('DB backup (fake) created')">DB Backup</button>
          <button class="btn btn-sm btn-outline-light" onclick="showToast('GST Voucher created (fake)')">GST Voucher</button>
          <button class="btn btn-sm btn-outline-light" onclick="showToast('Device registered (fake)')">Device Register</button>
        </div>
      </div>
    </section>

    <section id="logoutSection" style="margin-top:12px; display:none;">
      <div class="card-glass" style="padding:14px;">
        <h5>Logout</h5>
        <p>Thanks for demo-ing Venkatesh Chits. Click any nav to continue demo.</p>
      </div>
    </section>

  </main>

  <!-- TOASTS -->
  <div id="toastContainer" class="toast-container"></div>

  <!-- MODALS -->
  <!-- Add Member Modal -->
  <div class="modal fade" id="modalAddMember" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content text-dark">
        <div class="modal-header"><h5 class="modal-title">Add Member (Demo)</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <input id="mName" class="form-control mb-2" placeholder="Name">
          <input id="mPhone" class="form-control mb-2" placeholder="Phone">
          <input id="mAddress" class="form-control mb-2" placeholder="Address">
          <select id="mGroup" class="form-select mb-2"></select>
          <input id="mChit" type="number" class="form-control mb-2" placeholder="Chit value">
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-primary" onclick="addMemberFromModal()">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Group Modal -->
  <div class="modal fade" id="modalAddGroup" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content text-dark">
        <div class="modal-header"><h5 class="modal-title">Add Group (Demo)</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <input id="gName" class="form-control mb-2" placeholder="Group name">
          <input id="gChit" type="number" class="form-control mb-2" placeholder="Chit value">
          <input id="gMembers" type="number" class="form-control mb-2" placeholder="Number of members">
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-success" onclick="addGroupFromModal()">Create</button>
        </div>
      </div>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // -------------------------
    // Fake data (50+ members, 20 groups)
    // -------------------------
    const groupsData = [
      { id:1, name:"Gold A", chit:10000, members:8, status:"Active" },
      { id:2, name:"Gold B", chit:10000, members:7, status:"Active" },
      { id:3, name:"Silver A", chit:8000, members:6, status:"Active" },
      { id:4, name:"Silver B", chit:8000, members:6, status:"Active" },
      { id:5, name:"Platinum A", chit:15000, members:5, status:"Active" },
      { id:6, name:"Platinum B", chit:15000, members:5, status:"Pending" },
      { id:7, name:"Bronze A", chit:5000, members:9, status:"Active" },
      { id:8, name:"Bronze B", chit:5000, members:10, status:"Active" },
      { id:9, name:"Diamond", chit:20000, members:4, status:"Active" },
      { id:10, name:"Family Plan", chit:12000, members:6, status:"Active" },
      { id:11, name:"Student Plan", chit:3000, members:12, status:"Active" },
      { id:12, name:"Women Group", chit:7000, members:8, status:"Active" },
      { id:13, name:"Farmers", chit:6000, members:7, status:"Active" },
      { id:14, name:"Traders", chit:9000, members:5, status:"Active" },
      { id:15, name:"Retiree", chit:4000, members:10, status:"Active" },
      { id:16, name:"Special X", chit:11000, members:6, status:"Pending" },
      { id:17, name:"Night Shift", chit:8000, members:6, status:"Active" },
      { id:18, name:"Weekend", chit:5000, members:9, status:"Active" },
      { id:19, name:"Enterprise", chit:25000, members:3, status:"Active" },
      { id:20, name:"Legacy", chit:10000, members:6, status:"Active" }
    ];

    // generate 56 members
    const membersData = [
      {id:1,name:"Suresh",phone:"9876543210",address:"Madurai",group:"Gold A",amount:10000,status:"Active"},
      {id:2,name:"Meena",phone:"8765432109",address:"Madurai",group:"Gold A",amount:10000,status:"Active"},
      {id:3,name:"Kumar",phone:"7654321098",address:"Madurai",group:"Silver A",amount:8000,status:"Pending"},
      {id:4,name:"Ravi",phone:"9543216789",address:"Madurai",group:"Bronze A",amount:5000,status:"Active"},
      {id:5,name:"Arun",phone:"9234567890",address:"Madurai",group:"Platinum A",amount:15000,status:"Processing"},
      {id:6,name:"Lakshmi",phone:"9123456780",address:"Madurai",group:"Gold B",amount:10000,status:"Active"},
      {id:7,name:"Raj",phone:"9012345678",address:"Madurai",group:"Silver B",amount:8000,status:"Active"},
      {id:8,name:"Vijay",phone:"9901234567",address:"Madurai",group:"Bronze B",amount:5000,status:"Pending"},
      {id:9,name:"Priya",phone:"9898765432",address:"Madurai",group:"Family Plan",amount:12000,status:"Active"},
      {id:10,name:"Gokul",phone:"9887654321",address:"Madurai",group:"Student Plan",amount:3000,status:"Active"},
      {id:11,name:"Anitha",phone:"9871234560",address:"Madurai",group:"Women Group",amount:7000,status:"Active"},
      {id:12,name:"Mani",phone:"9765432109",address:"Madurai",group:"Farmers",amount:6000,status:"Active"},
      {id:13,name:"Selvi",phone:"9654321098",address:"Madurai",group:"Traders",amount:9000,status:"Active"},
      {id:14,name:"Prakash",phone:"9543210897",address:"Madurai",group:"Retiree",amount:4000,status:"Active"},
      {id:15,name:"Shiva",phone:"9432109876",address:"Madurai",group:"Special X",amount:11000,status:"Pending"},
      {id:16,name:"Uma",phone:"9321098765",address:"Madurai",group:"Night Shift",amount:8000,status:"Active"},
      {id:17,name:"Karthik",phone:"9210987654",address:"Madurai",group:"Weekend",amount:5000,status:"Active"},
      {id:18,name:"Malar",phone:"9109876543",address:"Madurai",group:"Enterprise",amount:25000,status:"Active"},
      {id:19,name:"Balu",phone:"9009876543",address:"Madurai",group:"Legacy",amount:10000,status:"Active"},
      {id:20,name:"Jayan",phone:"8909876543",address:"Madurai",group:"Gold A",amount:10000,status:"Active"},
      {id:21,name:"Sangeetha",phone:"8809876543",address:"Madurai",group:"Gold B",amount:10000,status:"Active"},
      {id:22,name:"Anand",phone:"8709876543",address:"Madurai",group:"Silver A",amount:8000,status:"Active"},
      {id:23,name:"Deepa",phone:"8609876543",address:"Madurai",group:"Bronze A",amount:5000,status:"Active"},
      {id:24,name:"Murugan",phone:"8509876543",address:"Madurai",group:"Platinum B",amount:15000,status:"Pending"},
      {id:25,name:"Sujatha",phone:"8409876543",address:"Madurai",group:"Bronze B",amount:5000,status:"Active"},
      {id:26,name:"Vasan",phone:"8309876543",address:"Madurai",group:"Gold A",amount:10000,status:"Active"},
      {id:27,name:"Ramesh",phone:"8209876543",address:"Madurai",group:"Silver B",amount:8000,status:"Active"},
      {id:28,name:"Kavitha",phone:"8109876543",address:"Madurai",group:"Family Plan",amount:12000,status:"Active"},
      {id:29,name:"Siva",phone:"8009876543",address:"Madurai",group:"Student Plan",amount:3000,status:"Pending"},
      {id:30,name:"Meenakshi",phone:"7909876543",address:"Madurai",group:"Women Group",amount:7000,status:"Active"},
      {id:31,name:"Sathish",phone:"7809876543",address:"Madurai",group:"Farmers",amount:6000,status:"Active"},
      {id:32,name:"Nandhini",phone:"7709876543",address:"Madurai",group:"Traders",amount:9000,status:"Active"},
      {id:33,name:"Kumaravel",phone:"7609876543",address:"Madurai",group:"Retiree",amount:4000,status:"Active"},
      {id:34,name:"Radha",phone:"7509876543",address:"Madurai",group:"Special X",amount:11000,status:"Pending"},
      {id:35,name:"Thiru",phone:"7409876543",address:"Madurai",group:"Night Shift",amount:8000,status:"Active"},
      {id:36,name:"Muthu",phone:"7309876543",address:"Madurai",group:"Weekend",amount:5000,status:"Active"},
      {id:37,name:"Elango",phone:"7209876543",address:"Madurai",group:"Enterprise",amount:25000,status:"Active"},
      {id:38,name:"Sowmiya",phone:"7109876543",address:"Madurai",group:"Legacy",amount:10000,status:"Active"},
      {id:39,name:"Abinaya",phone:"7009876543",address:"Madurai",group:"Gold B",amount:10000,status:"Active"},
      {id:40,name:"Lokesh",phone:"6909876543",address:"Madurai",group:"Silver A",amount:8000,status:"Active"},
      {id:41,name:"Priyanka",phone:"6809876543",address:"Madurai",group:"Bronze A",amount:5000,status:"Active"},
      {id:42,name:"Arvind",phone:"6709876543",address:"Madurai",group:"Platinum A",amount:15000,status:"Active"},
      {id:43,name:"Bhavani",phone:"6609876543",address:"Madurai",group:"Family Plan",amount:12000,status:"Active"},
      {id:44,name:"Chetan",phone:"6509876543",address:"Madurai",group:"Student Plan",amount:3000,status:"Active"},
      {id:45,name:"Durga",phone:"6409876543",address:"Madurai",group:"Women Group",amount:7000,status:"Active"},
      {id:46,name:"Ezhil",phone:"6309876543",address:"Madurai",group:"Farmers",amount:6000,status:"Active"},
      {id:47,name:"Farooq",phone:"6209876543",address:"Madurai",group:"Traders",amount:9000,status:"Active"},
      {id:48,name:"Geetha",phone:"6109876543",address:"Madurai",group:"Retiree",amount:4000,status:"Active"},
      {id:49,name:"Hari",phone:"6009876543",address:"Madurai",group:"Special X",amount:11000,status:"Pending"},
      {id:50,name:"Irfan",phone:"5909876543",address:"Madurai",group:"Night Shift",amount:8000,status:"Active"},
      {id:51,name:"Jaya",phone:"5809876543",address:"Madurai",group:"Weekend",amount:5000,status:"Active"},
      {id:52,name:"Kishore",phone:"5709876543",address:"Madurai",group:"Enterprise",amount:25000,status:"Active"},
      {id:53,name:"Latha",phone:"5609876543",address:"Madurai",group:"Legacy",amount:10000,status:"Active"},
      {id:54,name:"Manohar",phone:"5509876543",address:"Madurai",group:"Gold A",amount:10000,status:"Active"},
      {id:55,name:"Nila",phone:"5409876543",address:"Madurai",group:"Gold B",amount:10000,status:"Active"},
      {id:56,name:"Omar",phone:"5309876543",address:"Madurai",group:"Bronze A",amount:5000,status:"Active"}
    ];

    // collections & ledger fake
    let collections = [
      {date:'2025-10-01', member:'Suresh', group:'Gold A', amount:10000, mode:'Cash'},
      {date:'2025-10-02', member:'Kumar', group:'Silver A', amount:8000, mode:'UPI'},
      {date:'2025-10-02', member:'Meena', group:'Gold A', amount:10000, mode:'Cash'}
    ];

    let ledger = [
      {date:'2025-10-01', desc:'Opening Balance', debit:0, credit:100000, balance:100000},
      {date:'2025-10-02', desc:'Collection - Suresh', debit:0, credit:10000, balance:110000},
      {date:'2025-10-02', desc:'Payment - Vendor', debit:5000, credit:0, balance:105000}
    ];

    // -------------------------
    // State for members table
    // -------------------------
    let membersState = {
      sortBy: 'id',
      sortDir: 'asc',
      page: 1,
      perPage: 10,
      filterText: '',
      filterGroup: '',
      filterStatus: ''
    };

    // -------------------------
    // Init on load
    // -------------------------
    function initDemo(){
      populateGroupFilters();
      renderGroupsTable();
      renderLedger();
      renderCollectionsTable();
      renderMembers();
      initCharts();
      updateClock();
      // pre-select Dashboard and show
      navigate('dashboard');
    }

    // -------------------------
    // NAVIGATION
    // -------------------------
    function navigate(sectionId, evt){
      // clear active
      document.querySelectorAll('.sidebar a.menu').forEach(a=>a.classList.remove('active'));
      if(evt && evt.target){
        let el = evt.target.closest('a.menu');
        if(el) el.classList.add('active');
      }
      // hide all sections
      const secMap = {
        dashboard: ['dashboardSection'],
        members: ['membersSection'],
        addMember: ['membersSection'],
        addGroup: ['groupsSection'],
        collection: ['collectionSection'],
        auction: ['auctionSection'],
        accounts: ['accountsSection'],
        reports: ['reportsSection'],
        settings: ['settingsSection'],
        logout: ['logoutSection']
      };
      // hide all
      document.querySelectorAll('main section, main div.card-glass').forEach(x=>{
        // leave main container cards like dashboard visible? we will manage by IDs
      });
      // show/hide by ids (explicit)
      const allSections = [
        'dashboardSection','membersSection','groupsSection','collectionSection','auctionSection','accountsSection','reportsSection','settingsSection','logoutSection'
      ];
      allSections.forEach(id => {
        const el = document.getElementById(id);
        if(el) el.style.display = 'none';
      });

      // Show requested
      const targetIds = secMap[sectionId] || ['dashboardSection'];
      targetIds.forEach(id => {
        const el = document.getElementById(id);
        if(el) el.style.display = (id === 'dashboardSection' ? 'block' : 'block');
      });

      // Some quick toggles: if addMember pressed, open modal
      if(sectionId === 'addMember') openAddMemberModal();
      if(sectionId === 'addGroup') openAddGroupModal();
      if(sectionId === 'membersSection' || sectionId === 'addMember'){
        // ensure members + groups visible
        document.getElementById('membersSection').style.display = 'block';
        document.getElementById('groupsSection').style.display = 'block';
      }
      // if collection selected show collection section
      if(sectionId === 'collection') document.getElementById('collectionSection').style.display = 'block';
      if(sectionId === 'auction') document.getElementById('auctionSection').style.display = 'block';
      if(sectionId === 'accounts') document.getElementById('accountsSection').style.display = 'block';
      if(sectionId === 'reports') document.getElementById('reportsSection').style.display = 'block';
      if(sectionId === 'settings') document.getElementById('settingsSection').style.display = 'block';
      if(sectionId === 'logout') document.getElementById('logoutSection').style.display = 'block';
    }

    // -------------------------
    // MEMBERS: render, sort, filter, paginate
    // -------------------------
    function renderMembers(){
      // apply filters
      let items = membersData.slice();

      // filter by global text
      const txt = (document.getElementById('globalSearch')?.value || '').trim().toLowerCase();
      if(txt){
        items = items.filter(m => (m.name + ' ' + m.phone + ' ' + m.address + ' ' + m.group).toLowerCase().includes(txt));
      }
      // filter by group select
      const g = document.getElementById('groupFilter')?.value || '';
      if(g) items = items.filter(m => m.group === g);
      // filter by status
      const s = document.getElementById('statusFilter')?.value || '';
      if(s) items = items.filter(m => m.status === s);

      // sorting
      const sortBy = membersState.sortBy;
      const dir = membersState.sortDir;
      items.sort((a,b)=>{
        let A = a[sortBy], B = b[sortBy];
        if(typeof A === 'string') A = A.toLowerCase();
        if(typeof B === 'string') B = B.toLowerCase();
        if(A < B) return dir === 'asc' ? -1 : 1;
        if(A > B) return dir === 'asc' ? 1 : -1;
        return 0;
      });

      // pagination
      const total = items.length;
      const perPage = membersState.perPage;
      const totalPages = Math.max(1, Math.ceil(total / perPage));
      if(membersState.page > totalPages) membersState.page = totalPages;
      const start = (membersState.page -1) * perPage;
      const pageItems = items.slice(start, start + perPage);

      // render rows
      const tbody = document.getElementById('membersTbody');
      tbody.innerHTML = '';
      pageItems.forEach(m=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${m.id}</td>
                        <td>${m.name}</td>
                        <td>${m.phone}</td>
                        <td>${m.group}</td>
                        <td>₹ ${m.amount.toLocaleString()}</td>
                        <td>${renderStatusBadge(m.status)}</td>
                        <td>
                          <button class="btn btn-sm btn-outline-light" onclick="openMemberView(${m.id})">View</button>
                          <button class="btn btn-sm btn-success" onclick="simulatePayment(${m.id})">Pay</button>
                        </td>`;
        tbody.appendChild(tr);
      });

      // pager
      const pager = document.getElementById('membersPager');
      pager.innerHTML = '';
      for(let p=1;p<=totalPages;p++){
        const li = document.createElement('li');
        li.className = 'page-item' + (p===membersState.page ? ' active' : '');
        li.innerHTML = `<a class="page-link" href="#" onclick="gotoPage(${p}); return false;">${p}</a>`;
        pager.appendChild(li);
      }

      // info
      document.getElementById('membersInfo').innerText = `Showing ${start+1}-${Math.min(start+perPage,total)} of ${total} members`;

      // update charts that depend on visible data
      updateGroupChartFromMembers(items);
      updateCollectionTrendFromMembers(items);
    }

    function renderStatusBadge(status){
      if(status === 'Active') return `<span class="badge bg-success">${status}</span>`;
      if(status === 'Pending') return `<span class="badge bg-danger">${status}</span>`;
      if(status === 'Processing') return `<span class="badge bg-warning text-dark">${status}</span>`;
      return `<span class="badge bg-secondary">${status}</span>`;
    }

    function sortMembers(key){
      if(membersState.sortBy === key) membersState.sortDir = (membersState.sortDir === 'asc' ? 'desc' : 'asc');
      else { membersState.sortBy = key; membersState.sortDir = 'asc'; }
      renderMembers();
    }

    function gotoPage(p){
      membersState.page = p;
      renderMembers();
    }

    function applyMemberFilter(){
      membersState.page = 1;
      renderMembers();
    }

    function resetFilters(){
      document.getElementById('globalSearch').value = '';
      document.getElementById('statusFilter').value = '';
      document.getElementById('groupFilter').value = '';
      membersState.page = 1;
      renderMembers();
    }

    // -------------------------
    // Groups rendering
    // -------------------------
    function renderGroupsTable(){
      const tbody = document.getElementById('groupsTbody');
      tbody.innerHTML = '';
      groupsData.forEach(g => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${g.name}</td><td>₹ ${g.chit.toLocaleString()}</td><td>${g.members}</td><td>${g.status === 'Active' ? '<span class="badge bg-success">Active</span>' : '<span class="badge bg-warning text-dark">Pending</span>'}</td>
                        <td><button class="btn btn-sm btn-outline-light" onclick="viewGroup('${g.name}')">View</button></td>`;
        tbody.appendChild(tr);
      });
      // populate group filter selects
      const sel = document.getElementById('groupFilter');
      sel.innerHTML = '<option value="">All groups</option>';
      groupsData.forEach(g => sel.innerHTML += `<option value="${g.name}">${g.name}</option>`);
      // also populate modal group select
      const mg = document.getElementById('mGroup');
      if(mg){ mg.innerHTML = '<option value="">-- choose group --</option>'; groupsData.forEach(g => mg.innerHTML += `<option value="${g.name}">${g.name}</option>`); }
    }

    // -------------------------
    // Collections & ledger
    // -------------------------
    function renderCollectionsTable(){
      const tbody = document.getElementById('collectionsTbody');
      tbody.innerHTML = '';
      collections.slice().reverse().forEach(c => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${c.date}</td><td>${c.member}</td><td>${c.group}</td><td>₹ ${c.amount.toLocaleString()}</td><td>${c.mode}</td>`;
        tbody.appendChild(tr);
      });
    }

    function renderLedger(){
      const tbody = document.getElementById('ledgerTbody');
      tbody.innerHTML = '';
      ledger.slice().reverse().forEach(l => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${l.date}</td><td>${l.desc}</td><td>₹ ${l.debit.toLocaleString()}</td><td>₹ ${l.credit.toLocaleString()}</td><td>₹ ${l.balance.toLocaleString()}</td>`;
        tbody.appendChild(tr);
      });
    }

    function markCollection(){
      const mem = document.getElementById('collectMember').value.trim();
      const amt = Number(document.getElementById('collectAmount').value || 0);
      const mode = document.getElementById('collectMode').value;
      if(!mem || !amt){ showToast('Enter member and amount'); return; }
      const d = new Date();
      const ds = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
      collections.push({date: ds, member: mem, group: 'Unknown', amount: amt, mode: mode});
      // ledger push
      const lastBal = ledger.length ? ledger[ledger.length-1].balance : 0;
      ledger.push({date: ds, desc:`Collection - ${mem}`, debit:0, credit:amt, balance:lastBal + amt});
      renderCollectionsTable(); renderLedger();
      showToast('Collection marked (demo)');
      // clear
      document.getElementById('collectMember').value=''; document.getElementById('collectAmount').value='';
    }

    // -------------------------
    // Member actions
    // -------------------------
    function openMemberView(id){
      const m = membersData.find(x=>x.id===id);
      if(!m) return showToast('Member not found');
      showToast(`Open member: ${m.name} (demo)`);
      // quick highlight: filter to this member in table
      document.getElementById('globalSearch').value = m.name;
      applyMemberFilter();
    }

    function simulatePayment(id){
      const m = membersData.find(x=>x.id===id);
      if(!m) return;
      // mark a fake collection
      const d = new Date(); const ds = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
      collections.push({date:ds, member:m.name, group:m.group, amount:m.amount, mode:'Cash'});
      const lastBal = ledger.length ? ledger[ledger.length-1].balance : 0;
      ledger.push({date:ds, desc:`Collection - ${m.name}`, debit:0, credit:m.amount, balance:lastBal + m.amount});
      renderCollectionsTable(); renderLedger();
      showToast(`${m.name} payment recorded (demo)`);
    }

    // -------------------------
    // Add Member & Group from modal
    // -------------------------
    function openAddMemberModal(){
      const modal = new bootstrap.Modal(document.getElementById('modalAddMember'));
      document.getElementById('mName').value=''; document.getElementById('mPhone').value=''; document.getElementById('mAddress').value=''; document.getElementById('mChit').value='';
      modal.show();
    }

    function addMemberFromModal(){
      const name = document.getElementById('mName').value.trim();
      const phone = document.getElementById('mPhone').value.trim();
      const addr = document.getElementById('mAddress').value.trim();
      const group = document.getElementById('mGroup').value || 'Unknown';
      const chit = Number(document.getElementById('mChit').value) || 5000;
      if(!name || !phone){ showToast('Name & Phone required'); return; }
      const newId = Math.max(...membersData.map(x=>x.id)) + 1;
      membersData.push({id:newId, name, phone, address:addr, group, amount:chit, status:'Active'});
      bootstrap.Modal.getInstance(document.getElementById('modalAddMember')).hide();
      renderMembers(); showToast('Member added (demo)');
    }

    function openAddGroupModal(){
      const modal = new bootstrap.Modal(document.getElementById('modalAddGroup'));
      document.getElementById('gName').value=''; document.getElementById('gChit').value=''; document.getElementById('gMembers').value='';
      modal.show();
    }

    function addGroupFromModal(){
      const name = document.getElementById('gName').value.trim();
      const chit = Number(document.getElementById('gChit').value) || 5000;
      const members = Number(document.getElementById('gMembers').value) || 6;
      if(!name){ showToast('Group name required'); return; }
      const id = Math.max(...groupsData.map(g=>g.id)) + 1;
      groupsData.push({id, name, chit, members, status:'Active'});
      bootstrap.Modal.getInstance(document.getElementById('modalAddGroup')).hide();
      renderGroupsTable(); renderMembers();
      showToast('Group created (demo)');
    }

    function viewGroup(name){
      showToast(`Group: ${name} (demo)`);
      // filter members by group
      document.getElementById('groupFilter').value = name; applyMemberFilter();
      // navigate to members section
      navigate('addMember');
    }

    // -------------------------
    // Auction behaviours
    // -------------------------
    let auctionChart;
    function startFakeAuction(){
      showToast('Auction started (demo)');
      // push random auction revenue point
      const val = Math.floor(Math.random()*10000)+5000;
      // update auction timeline chart
      if(auctionChart){
        auctionChart.data.labels.push(`A${auctionChart.data.labels.length+1}`);
        auctionChart.data.datasets[0].data.push(val);
        auctionChart.update();
      }
    }

    function loadAuctionHistory(){
      showToast('Auction history loaded (demo)');
    }

    // -------------------------
    // Charts: init & update
    // -------------------------
    let collectionTrendChart, groupShareChart;
    function initCharts(){
      // collection trend
      const ctx = document.getElementById('chartCollectionTrend').getContext('2d');
      collectionTrendChart = new Chart(ctx, {
        type:'line',
        data: {
          labels: ['Jul','Aug','Sep','Oct','Nov','Dec'],
          datasets: [{ label:'Collections (₹)', data:[120000,150000,130000,245600,160000,175000], borderWidth:2, tension:0.3, fill:true, backgroundColor:'rgba(0,212,255,0.08)', borderColor:'#00d4ff' }]
        },
        options:{ responsive:true, maintainAspectRatio:false, plugins:{legend:{display:false}} }
      });

      // group share (pie)
      const ctx2 = document.getElementById('chartGroupShare').getContext('2d');
      groupShareChart = new Chart(ctx2, {
        type:'doughnut',
        data: { labels: groupsData.slice(0,6).map(g=>g.name), datasets:[{ data: groupsData.slice(0,6).map(g=>g.members*10), backgroundColor:['#00FFAA','#FFAA00','#FF4444','#9b59b6','#3498db','#f39c12'] }] },
        options:{ responsive:true, maintainAspectRatio:false, plugins:{legend:{position:'bottom'}} }
      });

      // auction timeline
      const ctx3 = document.getElementById('auctionTimeline').getContext('2d');
      auctionChart = new Chart(ctx3, {
        type:'bar',
        data: { labels:['A1','A2','A3'], datasets:[{ label:'Auction Bids (₹)', data:[5000,7000,6500], backgroundColor:'#FFAA00' }] },
        options:{ responsive:true, maintainAspectRatio:false }
      });

      // reports charts
      const ctx4 = document.getElementById('monthlyCollectionChart')?.getContext('2d');
      // If exists (older template) skip to avoid null
      try{
        new Chart(ctx4, { type:'bar', data:{ labels:['Oct1','Oct2','Oct3'], datasets:[{label:'Collections', data:[10000,8000,9500]}] }});
      }catch(e){}
      const ctx5 = document.getElementById('auctionPieChart')?.getContext('2d');
      try{
        new Chart(ctx5,{ type:'pie', data:{ labels:['Gold A','Silver B','Platinum C'], datasets:[{ data:[40,35,25] }] }});
      }catch(e){}
    }

    function updateGroupChartFromMembers(filteredMembers){
      // compute top 6 groups counts
      const map = {};
      filteredMembers.forEach(m => map[m.group] = (map[m.group]||0)+1);
      const sorted = Object.entries(map).sort((a,b)=>b[1]-a[1]).slice(0,6);
      if(sorted.length === 0) return;
      groupShareChart.data.labels = sorted.map(x=>x[0]);
      groupShareChart.data.datasets[0].data = sorted.map(x=>x[1]);
      groupShareChart.update();
    }

    function updateCollectionTrendFromMembers(filteredMembers){
      // simplistic: set trend points as counts * amount
      const months = ['Jul','Aug','Sep','Oct','Nov','Dec'];
      const data = months.map((m,i) => 120000 + (i*5000) + (filteredMembers.length*200));
      collectionTrendChart.data.datasets[0].data = data;
      collectionTrendChart.update();
    }

    // -------------------------
    // Ledger init / others
    // -------------------------
    function showToast(msg){
      const container = document.getElementById('toastContainer');
      const id = 't' + Date.now();
      const el = document.createElement('div');
      el.className = 'toast align-items-center text-bg-dark border-0 show';
      el.role = 'alert';
      el.innerHTML = `<div class="d-flex"><div class="toast-body">${msg}</div><button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button></div>`;
      container.appendChild(el);
      setTimeout(()=>{ try{ el.remove(); }catch(e){} }, 3000);
    }

    function exportFakePDF(){
      showToast('Preparing PDF (demo) ...');
      // small fake preview
      const preview = document.getElementById('reportPreview');
      preview.innerText = `Venkatesh Chits - Collections Report\nDate: ${new Date().toLocaleDateString()}\n\nTop collections:\n` + collections.slice(-6).reverse().map(c=>`${c.date} - ${c.member} - ₹ ${c.amount}`).join('\n');
    }

    // -------------------------
    // Small utilities & init
    // -------------------------
    function populateGroupFilters(){
      const gf = document.getElementById('groupFilter');
      if(!gf) return;
      gf.innerHTML = '<option value="">All groups</option>';
      groupsData.forEach(g => gf.innerHTML += `<option value="${g.name}">${g.name}</option>`);
    }

    function updateClock(){
      const d = new Date();
      document.getElementById('clock').innerText = d.toLocaleTimeString();
      document.getElementById('dateStr').innerText = d.toLocaleDateString();
      setTimeout(updateClock,1000);
    }

    // -------------------------
    // Collections render on load
    // -------------------------
    function initUI(){
      renderMembers();
      renderGroupsTable();
      renderCollectionsTable();
      renderLedger();
    }

    // -------------------------
    // Simple pager control (already used)
    // -------------------------
    // already implemented: gotoPage

    // -------------------------
    // Initialize charts and UI at end
    // -------------------------
    function initChartsAndUIOnLoad(){
      initCharts();
      renderMembers();
      renderGroupsTable();
      renderCollectionsTable();
    }

    // small helper to tie everything
    function initEverything(){
      populateGroupFilters();
      renderGroupsTable();
      renderCollectionsTable();
      renderLedger();
      renderMembers();
    }

    // Expose some functions to window for HTML inline usage
    window.initDemo = function(){ initChartsAndUIOnLoad(); initEverything(); updateClock(); };

    // Extra: quickly pre-render some things
    // ensure members table is ready (call renderMembers once)
    // (initDemo will be called by body onload)

  </script>

</body>
</html>

